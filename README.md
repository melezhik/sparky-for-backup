# sparky-for-backup

# HLD

![hld](images/HLD.png)

Архитектурная схема

- на всех нодах развернуты sparky агенты которые с переодичностью настраивают и выпонлняют бэкапы
- агенты также гарантируют изначальную настройку borg репозиториев
- у сервиса требующего бэкап может быть кастомная логика создания бэкапа ( например для сервиса Postgresql сначал бэкап создаетс через pg_dump и потом направляется в borg репозиторий )
- агенты отправляют данные ( в различном формате ) о бэкапах в sparky оркестратор ( по https протоколу ), орекстратор обрабатывает полученные данные с нод и агрегирует их ввиде различных отчетов, данные также могут перенаправлятся в консоль exioma для последующего просмотра пользователем, также отчеты можно напрямую смотреть через UI орекстратора
- при необходимости бэкапа могут быть запущеные в ручном режиме ( например в случае разовых сбоев ) , для это используется sparky окрестартор к которым агенты взаимодецтсвуютв  режиме pull через http очередь
